# 3.1 概述和传输层服务

网络层向上层提供的服务可以丢失、重排、出错，传输层在网络层提供的服务的基础上对可靠性的不足加以弥补，从而向上层提供可靠的服务（由rdt实现）。

## 传输层向上层提供的服务：
* 为应用层提供逻辑的通讯服务
* **进程与进程**之间以message为单位的逻辑的通信
  * 依赖于网络层的服务（延时、带宽）
  * 并对网络层的服务进行增强
* 多路复用，解复用
* 带宽和延时不可以被加强。

![传输服务](image.png)

* TCP协议：可靠、保序的传输。
    * **字节流**的服务
    * 多路复用、解复用
    * 拥塞控制
    * 流量控制
    * 建立连接

* UDP协议：不可靠，不保序的传输，没有为尽力而为的IP服务添加更多的其它额外服务。
    * **数据报**的服务
    * 多路复用、解复用

# 3.2 多路复用与解复用

看PPT就行

* TCP整合四元组（源IP，源port，目标IP，目标port）
* UDP整合二元组（目标IP，目标port）

# 3.3 无连接传输：UDP

## UDP：User Datagram Protocol

* 无连接，发送端和接收端之间没有握手，报文段可能丢失，乱序
* UDP被用于：
    * 流媒体（丢失不敏感，速率敏感、应用可控制传输速率） 
    * DNS
    * SNMP
* 要想在UDP上进行可靠传输，需要在应用层增加可靠性
* UDP的优点：  **PPT 3-21**

## UDP校验和

* 目标： 检测在被传输报文段中的差错 (如比特反转)
* 将报文段视为16bit的整数，求和作比较
* 校验和也有可能检测不出问题（残存错误）

# 3.4 可靠数据传输的原理

可靠数据传输（rdt）：网络层向上层提供的服务可以丢失、重排、出错，传输层在网络层提供的服务的基础上对可靠性的不足加以弥补，从而向上层提供可靠的服务。

* rdt在应用层、传输层和数据链路层都很重要
* 信道的不可靠特点决定了可靠数据传输协议（rdt）的复杂性

## Rdt1.0： 在可靠信道上的可靠数据传输

* 下层的信道是完全可靠的
    * 没有比特出错
    * 没有分组丢失
* 发送方和接收方的FSM
    * 发送方将数据发送到下层信道
    * 接收方从下层信道接收数据
* 只做封装、解封装工作

## Rdt2.0：具有比特差错的信道

* 下层信道可能会出错：将分组中的比特翻转

**14:38**